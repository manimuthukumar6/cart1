# cart1

## Development

### Setting up the environment

We keep the common react components, on another project `abof-react-components`. This can be used across multiple projects in future. `abof-react-components` is used in this project as a GIT submodule.

Once you checked out the prject from the GIT, run

    $ git submodule update --init # fetches and updates the submodules

This command needs be run every time after you do `git fetch` or `git pull`, on this project to update the submodule.

### Running the develpment instance

To run a local development server with file watching, run:

    $ gulp

## Release

To build the application, run:

    $ gulp build

You can specify a `NODE_ENV` on the command line if you want (default is `development`):

    $ NODE_ENV=production gulp build

For production releases, always set `NODE_ENV` to `production`. When `NODE_ENV` is set to `development`, all
optimizations are turned off.

The build process generates the following assets under the `dist/${NODE_ENV}/${VERSION}` directory:

- `public/index.html`: HTML file that is served to the user
- `public/js/abof-checkout.${VERSION}.client.js`: the client-side JavaScript bundle that is served to the user
- `abof-checkout.${VERSION}.server.js`: the server-side JavaScript bundle for pre-rendering using Node
- `public/css/abof-checkout.${VERSION}.css`: the CSS bundle that is served to the user
- `public/`: a directory containing static assets such as images, fonts, favicons, etc.
- `config/`: a copy of the `config/` directory
- `package.json`: a copy of `pacakge.json`

`VERSION` is the value returned by `git describe --tags --always --dirty="-dirty"`. The assets generated by the build
process can be directly uploaded to a server running `node` and `npm`. There is no need to clone the entire project
on the server.

## Configuration & Deployment

Assuming a production release of the application has been built, it can be served as follows:

    $ cd path/to/dist/production/${VERSION}/
    $ npm install
    $ node dist/production/abof-checkout.${VERSION}.server.js

This will install the minimal set of dependencies required to run the project in the `dist` directory and serve the
project on the default port (8080) with the default path configuration (`config/paths/production.js`).

To change these settings, run:

    $ PORT=9001 RUNTIME_ENVIRONMENT=${ENVIRONMENT_NAME} node dist/production/abof-checkout.${VERSION}.server.js

Add environment specific configuration keys to `config/runtimeEnvironmentConfig.js`. Use `GOOGLE_CLIENT_ID`
and `FACEBOOK_APP_ID` to override Google/Facebook IDs for social login.. 
